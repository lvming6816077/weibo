{"remainingRequest":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/views/repost/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/views/repost/index.vue","mtime":1581861100401},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBoZWFkZXJiYXIgZnJvbSAnQC9jb21wb25lbnRzL2hlYWRlcmJhcicKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdyZXBvc3QnLAogIGNvbXBvbmVudHM6ewogICAgaGVhZGVyYmFyCiAgfSwKICBkYXRhKCl7CiAgICByZXR1cm4gewogICAgICBwb3N0Q29udGVudDogJycsCiAgICAgIHRleHRDb3VudDogMCwKICAgICAgaW1hZ2VMaXN0OiBbXQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGltZ1N0eWxlICgpIHsKICAgICAgcmV0dXJuIHVybCA9PiB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGJhY2tncm91bmRJbWFnZTogJ3VybCgnICsgdXJsICsgJyknCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY3VycmVudFVzZXIoKXsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRVc2VyCiAgICB9LAogICAgdG9SZXBvc3REYXRhKCl7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5zdGF0ZS50b1JlcG9zdERhdGEpIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUudG9SZXBvc3REYXRhLm1ibG9nCiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsCiAgICAgIAogICAgfQogIH0sCiAgbWV0aG9kczp7CiAgICBvbmlucHV0KCl7CiAgICAgIHRoaXMudGV4dENvdW50ID0gdGhpcy5wb3N0Q29udGVudC5sZW5ndGgKICAgIH0sCgogICAgZG9SZXBvc3QoKXsKICAgICAgbGV0IG9iaiA9IHsKICAgICAgICBtYmxvZzogewogICAgICAgICAgaWQ6IERhdGUubm93KCksCiAgICAgICAgICBhdHRpdGlkZXNfY291bnQ6IDAsCiAgICAgICAgICByZXBvc3RzX2NvdW50OiAwLAogICAgICAgICAgY29tbWVudHNfY291bnQ6IDAsCiAgICAgICAgICBzb3VyY2U6ICflvq7ljZptb2JpbGXniYgnLAogICAgICAgICAgdGV4dDogdGhpcy5wb3N0Q29udGVudCwKICAgICAgICAgIHBpY3M6W10sCiAgICAgICAgICByZXR3ZWV0ZWRfc3RhdHVzOiB0aGlzLnRvUmVwb3N0RGF0YSwKICAgICAgICAgIHVzZXI6IHsKICAgICAgICAgICAgc2NyZWVuX25hbWU6IHRoaXMuY3VycmVudFVzZXIuc2NyZWVuX25hbWUsCiAgICAgICAgICAgIHByb2ZpbGVfaW1hZ2VfdXJsOiB0aGlzLmN1cnJlbnRVc2VyLnByb2ZpbGVfaW1hZ2VfdXJsLAogICAgICAgICAgICBiYWRnZTp7CiAgICAgICAgICAgICAgdXNlcl9uYW1lX2NlcnRpZmljYXRlOiB0aGlzLmN1cnJlbnRVc2VyLnZlcmlmaWVkCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdhZGRQb3N0JyxvYmopCiAgICAgIG11aS50b2FzdCgn6L2s5Y+R5oiQ5YqfJykKICAgICAgdGhpcy4kcm91dGVyLmJhY2soKQogICAgfSwKICAgIGZvcm1hdFRleHQodmFsdWUpewogICAgICAvLyDov4fmu6Tpk77mjqXkuK3lj6/og73lvJXlj5Hot7PovaznmoTpgLvovpEKICAgICAgbGV0IHJlZyA9IC9ocmVmPSgifCcpKC4rPykoInwnKS9naTsKCiAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKHJlZywgJycpLnJlcGxhY2UoLzxiciBcLz48YnIgXC8+L2csICc8YnIgLz4nKQogICAgfQogIH0KCn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA","file":"index.vue","sourceRoot":"src/views/repost","sourcesContent":["<template>\n  <div class=\"container\">\n    <headerbar useRightBtn=\"提交\" :useBack=\"true\" title=\"转发微博\" @rightBtnClick=\"doRepost\"></headerbar>\n    <textarea id=\"postContent\"\n      maxlength=\"300\"\n      placeholder=\"请输入文字...\"\n      @input=\"oninput\"\n      v-model=\"postContent\"></textarea>\n    <div class=\"text-count\"><span class=\"left-count\">{{textCount}}</span>/300</div>\n    <div class=\"repost-info\" v-if=\"toRepostData\">\n      <div v-if=\"toRepostData.pics.length\" class=\"left-image\" :style=\"imgStyle(toRepostData.pics[0].url)\">\n      </div>\n      <div class=\"right-info\">\n        <div class=\"nickname\">\n          @{{toRepostData.user.screen_name}}\n        </div>\n        <div class=\"repost-content two-line\" v-html=\"formatText(toRepostData.text)\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport headerbar from '@/components/headerbar'\nexport default {\n  name: 'repost',\n  components:{\n    headerbar\n  },\n  data(){\n    return {\n      postContent: '',\n      textCount: 0,\n      imageList: []\n    }\n  },\n  computed: {\n    imgStyle () {\n      return url => {\n        return {\n          backgroundImage: 'url(' + url + ')'\n        }\n      }\n    },\n    currentUser(){\n      return this.$store.state.currentUser\n    },\n    toRepostData(){\n      if (this.$store.state.toRepostData) {\n        return this.$store.state.toRepostData.mblog\n      }\n\n      return null\n      \n    }\n  },\n  methods:{\n    oninput(){\n      this.textCount = this.postContent.length\n    },\n\n    doRepost(){\n      let obj = {\n        mblog: {\n          id: Date.now(),\n          attitides_count: 0,\n          reposts_count: 0,\n          comments_count: 0,\n          source: '微博mobile版',\n          text: this.postContent,\n          pics:[],\n          retweeted_status: this.toRepostData,\n          user: {\n            screen_name: this.currentUser.screen_name,\n            profile_image_url: this.currentUser.profile_image_url,\n            badge:{\n              user_name_certificate: this.currentUser.verified\n            }\n          }\n        }\n      }\n\n      this.$store.dispatch('addPost',obj)\n      mui.toast('转发成功')\n      this.$router.back()\n    },\n    formatText(value){\n      // 过滤链接中可能引发跳转的逻辑\n      let reg = /href=(\"|')(.+?)(\"|')/gi;\n\n      return value.replace(reg, '').replace(/<br \\/><br \\/>/g, '<br />')\n    }\n  }\n\n}\n</script>\n<style scoped>\n.container {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  background-color: #fff;\n}\n#postContent {\n  margin-top: 45px;\n  border: none;\n  font-size: 16px;\n  width: 100%;\n  height: 200px;\n  box-sizing: border-box;\n}\n.text-count {\n  font-size: 14px;\n  color: #707070;\n  position: absolute;\n  right: 20px;\n  top: 230px;\n}\n.repost-info {\n  display: flex;\n  background-color: #f7f7f7;\n}\n.left-image {\n  width: 84px;\n  height: 84px;\n  background-size: cover;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n.right-info {\n  flex: 1px;\n  padding-left: 10px;\n  justify-content: center;\n  display: flex;\n  flex-direction: column;\n  padding-right: 10px;\n}\n.nickname {\n  color: #333;\n  font-size: 14px;\n}\n.repost-content {\n  color: #939393;\n  font-size: 13px;\n}\n</style>\n"]}]}