{"remainingRequest":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/components/scrollview/index.vue?vue&type=style&index=0&id=4a1115f6&scoped=true&lang=css&","dependencies":[{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/components/scrollview/index.vue","mtime":1581327364511},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5sb2FkbW9yZSB7CiAgd2lkdGg6IDY1JTsKICBtYXJnaW46IDIwcHggYXV0bzsKICBsaW5lLWhlaWdodDogMjBweDsKICBmb250LXNpemU6IDE0cHg7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9Ci5sb2FkbW9yZS10aXBzIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsKICBjb2xvcjogI2FiYWJhYjsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/scrollview","sourcesContent":["<template>\n  <div class=\"scrollview\">\n    <slot></slot>\n    <div class=\"loadmore\">\n      <span class=\"loadmore-tips\">{{loadEnd ? '已加载完毕':'正在加载...'}}</span>\n    </div>\n  </div>\n</template>\n<script>\n  export default {\n  name: 'scrollview',\n  props:{\n    readyToLoad: Boolean,\n    isend: Boolean,\n    dataList: Array\n  },\n  computed:{\n    loadEnd(){\n      return this.isend || this.dataList.length == 0\n    }\n  },\n  mounted () {\n    window.addEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  beforeDestroy () {\n    // 在组件销毁时要移除scroll事件\n    window.removeEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  activated () {\n    window.addEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  deactivated () {\n    // 在组件切换走时要移除scroll事件\n    window.removeEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  methods:{\n    onLoadPage () {\n      // 获取clientHeight\n      let clientHeight = document.documentElement.clientHeight\n      // 获取scrollHeight\n      let scrollHeight = document.body.scrollHeight\n      // 获取scrollTop这里注意要兼容一下，某些机型的document.documentElement.scrollTop可能为0\n      let scrollTop = document.documentElement.scrollTop || document.body.scrollTop\n\n      // 通知父组件触发滚动事件\n      this.$emit('scroll', scrollTop)\n      // 通知距离底部还有多少px的阈值\n      let proLoadDis = 60\n      // 判断是否页面滚动到底部\n      if ((scrollTop + clientHeight) >= (scrollHeight - proLoadDis)) { // 560 1915\n        // 是否已经滚动到最后一页\n        if (!this.loadEnd) {\n          // 判断在一个api请求未完成时不能触发第二次滚动到底部的回调\n          if (!this.readyToLoad) {\n            return\n          }\n\n          // 通知父组件触发滚动到底部事件\n          this.$emit('loadCallback')\n        }\n      }\n    }\n  }\n\n}\n</script>\n<style scoped>\n.loadmore {\n  width: 65%;\n  margin: 20px auto;\n  line-height: 20px;\n  font-size: 14px;\n  text-align: center;\n}\n.loadmore-tips {\n  display: inline-block;\n  vertical-align: middle;\n  color: #ababab;\n}\n</style>"]}]}