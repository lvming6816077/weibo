{"remainingRequest":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/components/scrollview/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/components/scrollview/index.vue","mtime":1581327364511},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCiAgZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdzY3JvbGx2aWV3JywKICBwcm9wczp7CiAgICByZWFkeVRvTG9hZDogQm9vbGVhbiwKICAgIGlzZW5kOiBCb29sZWFuLAogICAgZGF0YUxpc3Q6IEFycmF5CiAgfSwKICBjb21wdXRlZDp7CiAgICBsb2FkRW5kKCl7CiAgICAgIHJldHVybiB0aGlzLmlzZW5kIHx8IHRoaXMuZGF0YUxpc3QubGVuZ3RoID09IDAKICAgIH0KICB9LAogIG1vdW50ZWQgKCkgewogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMub25Mb2FkUGFnZS5iaW5kKHRoaXMpKQogIH0sCiAgYmVmb3JlRGVzdHJveSAoKSB7CiAgICAvLyDlnKjnu4Tku7bplIDmr4Hml7bopoHnp7vpmaRzY3JvbGzkuovku7YKICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLm9uTG9hZFBhZ2UuYmluZCh0aGlzKSkKICB9LAogIGFjdGl2YXRlZCAoKSB7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5vbkxvYWRQYWdlLmJpbmQodGhpcykpCiAgfSwKICBkZWFjdGl2YXRlZCAoKSB7CiAgICAvLyDlnKjnu4Tku7bliIfmjaLotbDml7bopoHnp7vpmaRzY3JvbGzkuovku7YKICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLm9uTG9hZFBhZ2UuYmluZCh0aGlzKSkKICB9LAogIG1ldGhvZHM6ewogICAgb25Mb2FkUGFnZSAoKSB7CiAgICAgIC8vIOiOt+WPlmNsaWVudEhlaWdodAogICAgICBsZXQgY2xpZW50SGVpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodAogICAgICAvLyDojrflj5ZzY3JvbGxIZWlnaHQKICAgICAgbGV0IHNjcm9sbEhlaWdodCA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0CiAgICAgIC8vIOiOt+WPlnNjcm9sbFRvcOi/memHjOazqOaEj+imgeWFvOWuueS4gOS4i++8jOafkOS6m+acuuWei+eahGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3Dlj6/og73kuLowCiAgICAgIGxldCBzY3JvbGxUb3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wCgogICAgICAvLyDpgJrnn6XniLbnu4Tku7bop6blj5Hmu5rliqjkuovku7YKICAgICAgdGhpcy4kZW1pdCgnc2Nyb2xsJywgc2Nyb2xsVG9wKQogICAgICAvLyDpgJrnn6Xot53nprvlupXpg6jov5jmnInlpJrlsJFweOeahOmYiOWAvAogICAgICBsZXQgcHJvTG9hZERpcyA9IDYwCiAgICAgIC8vIOWIpOaWreaYr+WQpumhtemdoua7muWKqOWIsOW6lemDqAogICAgICBpZiAoKHNjcm9sbFRvcCArIGNsaWVudEhlaWdodCkgPj0gKHNjcm9sbEhlaWdodCAtIHByb0xvYWREaXMpKSB7IC8vIDU2MCAxOTE1CiAgICAgICAgLy8g5piv5ZCm5bey57uP5rua5Yqo5Yiw5pyA5ZCO5LiA6aG1CiAgICAgICAgaWYgKCF0aGlzLmxvYWRFbmQpIHsKICAgICAgICAgIC8vIOWIpOaWreWcqOS4gOS4qmFwaeivt+axguacquWujOaIkOaXtuS4jeiDveinpuWPkeesrOS6jOasoea7muWKqOWIsOW6lemDqOeahOWbnuiwgwogICAgICAgICAgaWYgKCF0aGlzLnJlYWR5VG9Mb2FkKSB7CiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgfQoKICAgICAgICAgIC8vIOmAmuefpeeItue7hOS7tuinpuWPkea7muWKqOWIsOW6lemDqOS6i+S7tgogICAgICAgICAgdGhpcy4kZW1pdCgnbG9hZENhbGxiYWNrJykKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cgp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"index.vue","sourceRoot":"src/components/scrollview","sourcesContent":["<template>\n  <div class=\"scrollview\">\n    <slot></slot>\n    <div class=\"loadmore\">\n      <span class=\"loadmore-tips\">{{loadEnd ? '已加载完毕':'正在加载...'}}</span>\n    </div>\n  </div>\n</template>\n<script>\n  export default {\n  name: 'scrollview',\n  props:{\n    readyToLoad: Boolean,\n    isend: Boolean,\n    dataList: Array\n  },\n  computed:{\n    loadEnd(){\n      return this.isend || this.dataList.length == 0\n    }\n  },\n  mounted () {\n    window.addEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  beforeDestroy () {\n    // 在组件销毁时要移除scroll事件\n    window.removeEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  activated () {\n    window.addEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  deactivated () {\n    // 在组件切换走时要移除scroll事件\n    window.removeEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  methods:{\n    onLoadPage () {\n      // 获取clientHeight\n      let clientHeight = document.documentElement.clientHeight\n      // 获取scrollHeight\n      let scrollHeight = document.body.scrollHeight\n      // 获取scrollTop这里注意要兼容一下，某些机型的document.documentElement.scrollTop可能为0\n      let scrollTop = document.documentElement.scrollTop || document.body.scrollTop\n\n      // 通知父组件触发滚动事件\n      this.$emit('scroll', scrollTop)\n      // 通知距离底部还有多少px的阈值\n      let proLoadDis = 60\n      // 判断是否页面滚动到底部\n      if ((scrollTop + clientHeight) >= (scrollHeight - proLoadDis)) { // 560 1915\n        // 是否已经滚动到最后一页\n        if (!this.loadEnd) {\n          // 判断在一个api请求未完成时不能触发第二次滚动到底部的回调\n          if (!this.readyToLoad) {\n            return\n          }\n\n          // 通知父组件触发滚动到底部事件\n          this.$emit('loadCallback')\n        }\n      }\n    }\n  }\n\n}\n</script>\n<style scoped>\n.loadmore {\n  width: 65%;\n  margin: 20px auto;\n  line-height: 20px;\n  font-size: 14px;\n  text-align: center;\n}\n.loadmore-tips {\n  display: inline-block;\n  vertical-align: middle;\n  color: #ababab;\n}\n</style>"]}]}