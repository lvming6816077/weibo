{"remainingRequest":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/babel-loader/lib/index.js!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/views/repost/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/views/repost/index.vue","mtime":1581861100401},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBoZWFkZXJiYXIgZnJvbSAnQC9jb21wb25lbnRzL2hlYWRlcmJhcic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAncmVwb3N0JywKICBjb21wb25lbnRzOiB7CiAgICBoZWFkZXJiYXI6IGhlYWRlcmJhcgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBvc3RDb250ZW50OiAnJywKICAgICAgdGV4dENvdW50OiAwLAogICAgICBpbWFnZUxpc3Q6IFtdCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGltZ1N0eWxlOiBmdW5jdGlvbiBpbWdTdHlsZSgpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uICh1cmwpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgYmFja2dyb3VuZEltYWdlOiAndXJsKCcgKyB1cmwgKyAnKScKICAgICAgICB9OwogICAgICB9OwogICAgfSwKICAgIGN1cnJlbnRVc2VyOiBmdW5jdGlvbiBjdXJyZW50VXNlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRVc2VyOwogICAgfSwKICAgIHRvUmVwb3N0RGF0YTogZnVuY3Rpb24gdG9SZXBvc3REYXRhKCkgewogICAgICBpZiAodGhpcy4kc3RvcmUuc3RhdGUudG9SZXBvc3REYXRhKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnRvUmVwb3N0RGF0YS5tYmxvZzsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBvbmlucHV0OiBmdW5jdGlvbiBvbmlucHV0KCkgewogICAgICB0aGlzLnRleHRDb3VudCA9IHRoaXMucG9zdENvbnRlbnQubGVuZ3RoOwogICAgfSwKICAgIGRvUmVwb3N0OiBmdW5jdGlvbiBkb1JlcG9zdCgpIHsKICAgICAgdmFyIG9iaiA9IHsKICAgICAgICBtYmxvZzogewogICAgICAgICAgaWQ6IERhdGUubm93KCksCiAgICAgICAgICBhdHRpdGlkZXNfY291bnQ6IDAsCiAgICAgICAgICByZXBvc3RzX2NvdW50OiAwLAogICAgICAgICAgY29tbWVudHNfY291bnQ6IDAsCiAgICAgICAgICBzb3VyY2U6ICflvq7ljZptb2JpbGXniYgnLAogICAgICAgICAgdGV4dDogdGhpcy5wb3N0Q29udGVudCwKICAgICAgICAgIHBpY3M6IFtdLAogICAgICAgICAgcmV0d2VldGVkX3N0YXR1czogdGhpcy50b1JlcG9zdERhdGEsCiAgICAgICAgICB1c2VyOiB7CiAgICAgICAgICAgIHNjcmVlbl9uYW1lOiB0aGlzLmN1cnJlbnRVc2VyLnNjcmVlbl9uYW1lLAogICAgICAgICAgICBwcm9maWxlX2ltYWdlX3VybDogdGhpcy5jdXJyZW50VXNlci5wcm9maWxlX2ltYWdlX3VybCwKICAgICAgICAgICAgYmFkZ2U6IHsKICAgICAgICAgICAgICB1c2VyX25hbWVfY2VydGlmaWNhdGU6IHRoaXMuY3VycmVudFVzZXIudmVyaWZpZWQKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2FkZFBvc3QnLCBvYmopOwogICAgICBtdWkudG9hc3QoJ+i9rOWPkeaIkOWKnycpOwogICAgICB0aGlzLiRyb3V0ZXIuYmFjaygpOwogICAgfSwKICAgIGZvcm1hdFRleHQ6IGZ1bmN0aW9uIGZvcm1hdFRleHQodmFsdWUpIHsKICAgICAgLy8g6L+H5ruk6ZO+5o6l5Lit5Y+v6IO95byV5Y+R6Lez6L2s55qE6YC76L6RCiAgICAgIHZhciByZWcgPSAvaHJlZj0oInwnKSguKz8pKCJ8JykvZ2k7CiAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKHJlZywgJycpLnJlcGxhY2UoLzxiciBcLz48YnIgXC8+L2csICc8YnIgLz4nKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAuBA,OAAA,SAAA,MAAA,wBAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,QADA;AAEA,EAAA,UAAA,EAAA;AACA,IAAA,SAAA,EAAA;AADA,GAFA;AAKA,EAAA,IALA,kBAKA;AACA,WAAA;AACA,MAAA,WAAA,EAAA,EADA;AAEA,MAAA,SAAA,EAAA,CAFA;AAGA,MAAA,SAAA,EAAA;AAHA,KAAA;AAKA,GAXA;AAYA,EAAA,QAAA,EAAA;AACA,IAAA,QADA,sBACA;AACA,aAAA,UAAA,GAAA,EAAA;AACA,eAAA;AACA,UAAA,eAAA,EAAA,SAAA,GAAA,GAAA;AADA,SAAA;AAGA,OAJA;AAKA,KAPA;AAQA,IAAA,WARA,yBAQA;AACA,aAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA;AACA,KAVA;AAWA,IAAA,YAXA,0BAWA;AACA,UAAA,KAAA,MAAA,CAAA,KAAA,CAAA,YAAA,EAAA;AACA,eAAA,KAAA,MAAA,CAAA,KAAA,CAAA,YAAA,CAAA,KAAA;AACA;;AAEA,aAAA,IAAA;AAEA;AAlBA,GAZA;AAgCA,EAAA,OAAA,EAAA;AACA,IAAA,OADA,qBACA;AACA,WAAA,SAAA,GAAA,KAAA,WAAA,CAAA,MAAA;AACA,KAHA;AAKA,IAAA,QALA,sBAKA;AACA,UAAA,GAAA,GAAA;AACA,QAAA,KAAA,EAAA;AACA,UAAA,EAAA,EAAA,IAAA,CAAA,GAAA,EADA;AAEA,UAAA,eAAA,EAAA,CAFA;AAGA,UAAA,aAAA,EAAA,CAHA;AAIA,UAAA,cAAA,EAAA,CAJA;AAKA,UAAA,MAAA,EAAA,WALA;AAMA,UAAA,IAAA,EAAA,KAAA,WANA;AAOA,UAAA,IAAA,EAAA,EAPA;AAQA,UAAA,gBAAA,EAAA,KAAA,YARA;AASA,UAAA,IAAA,EAAA;AACA,YAAA,WAAA,EAAA,KAAA,WAAA,CAAA,WADA;AAEA,YAAA,iBAAA,EAAA,KAAA,WAAA,CAAA,iBAFA;AAGA,YAAA,KAAA,EAAA;AACA,cAAA,qBAAA,EAAA,KAAA,WAAA,CAAA;AADA;AAHA;AATA;AADA,OAAA;AAoBA,WAAA,MAAA,CAAA,QAAA,CAAA,SAAA,EAAA,GAAA;AACA,MAAA,GAAA,CAAA,KAAA,CAAA,MAAA;AACA,WAAA,OAAA,CAAA,IAAA;AACA,KA7BA;AA8BA,IAAA,UA9BA,sBA8BA,KA9BA,EA8BA;AACA;AACA,UAAA,GAAA,GAAA,wBAAA;AAEA,aAAA,KAAA,CAAA,OAAA,CAAA,GAAA,EAAA,EAAA,EAAA,OAAA,CAAA,iBAAA,EAAA,QAAA,CAAA;AACA;AAnCA;AAhCA,CAAA","sourcesContent":["<template>\n  <div class=\"container\">\n    <headerbar useRightBtn=\"提交\" :useBack=\"true\" title=\"转发微博\" @rightBtnClick=\"doRepost\"></headerbar>\n    <textarea id=\"postContent\"\n      maxlength=\"300\"\n      placeholder=\"请输入文字...\"\n      @input=\"oninput\"\n      v-model=\"postContent\"></textarea>\n    <div class=\"text-count\"><span class=\"left-count\">{{textCount}}</span>/300</div>\n    <div class=\"repost-info\" v-if=\"toRepostData\">\n      <div v-if=\"toRepostData.pics.length\" class=\"left-image\" :style=\"imgStyle(toRepostData.pics[0].url)\">\n      </div>\n      <div class=\"right-info\">\n        <div class=\"nickname\">\n          @{{toRepostData.user.screen_name}}\n        </div>\n        <div class=\"repost-content two-line\" v-html=\"formatText(toRepostData.text)\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport headerbar from '@/components/headerbar'\nexport default {\n  name: 'repost',\n  components:{\n    headerbar\n  },\n  data(){\n    return {\n      postContent: '',\n      textCount: 0,\n      imageList: []\n    }\n  },\n  computed: {\n    imgStyle () {\n      return url => {\n        return {\n          backgroundImage: 'url(' + url + ')'\n        }\n      }\n    },\n    currentUser(){\n      return this.$store.state.currentUser\n    },\n    toRepostData(){\n      if (this.$store.state.toRepostData) {\n        return this.$store.state.toRepostData.mblog\n      }\n\n      return null\n      \n    }\n  },\n  methods:{\n    oninput(){\n      this.textCount = this.postContent.length\n    },\n\n    doRepost(){\n      let obj = {\n        mblog: {\n          id: Date.now(),\n          attitides_count: 0,\n          reposts_count: 0,\n          comments_count: 0,\n          source: '微博mobile版',\n          text: this.postContent,\n          pics:[],\n          retweeted_status: this.toRepostData,\n          user: {\n            screen_name: this.currentUser.screen_name,\n            profile_image_url: this.currentUser.profile_image_url,\n            badge:{\n              user_name_certificate: this.currentUser.verified\n            }\n          }\n        }\n      }\n\n      this.$store.dispatch('addPost',obj)\n      mui.toast('转发成功')\n      this.$router.back()\n    },\n    formatText(value){\n      // 过滤链接中可能引发跳转的逻辑\n      let reg = /href=(\"|')(.+?)(\"|')/gi;\n\n      return value.replace(reg, '').replace(/<br \\/><br \\/>/g, '<br />')\n    }\n  }\n\n}\n</script>\n<style scoped>\n.container {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  background-color: #fff;\n}\n#postContent {\n  margin-top: 45px;\n  border: none;\n  font-size: 16px;\n  width: 100%;\n  height: 200px;\n  box-sizing: border-box;\n}\n.text-count {\n  font-size: 14px;\n  color: #707070;\n  position: absolute;\n  right: 20px;\n  top: 230px;\n}\n.repost-info {\n  display: flex;\n  background-color: #f7f7f7;\n}\n.left-image {\n  width: 84px;\n  height: 84px;\n  background-size: cover;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n.right-info {\n  flex: 1px;\n  padding-left: 10px;\n  justify-content: center;\n  display: flex;\n  flex-direction: column;\n  padding-right: 10px;\n}\n.nickname {\n  color: #333;\n  font-size: 14px;\n}\n.repost-content {\n  color: #939393;\n  font-size: 13px;\n}\n</style>\n"],"sourceRoot":"src/views/repost"}]}