{"remainingRequest":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/babel-loader/lib/index.js!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/components/scrollview/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/src/components/scrollview/index.vue","mtime":1581327364511},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lvming/Desktop/work/personWork/webappBook/weibosource/weibo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdzY3JvbGx2aWV3JywKICBwcm9wczogewogICAgcmVhZHlUb0xvYWQ6IEJvb2xlYW4sCiAgICBpc2VuZDogQm9vbGVhbiwKICAgIGRhdGFMaXN0OiBBcnJheQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGxvYWRFbmQ6IGZ1bmN0aW9uIGxvYWRFbmQoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzZW5kIHx8IHRoaXMuZGF0YUxpc3QubGVuZ3RoID09IDA7CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMub25Mb2FkUGFnZS5iaW5kKHRoaXMpKTsKICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICAvLyDlnKjnu4Tku7bplIDmr4Hml7bopoHnp7vpmaRzY3JvbGzkuovku7YKICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLm9uTG9hZFBhZ2UuYmluZCh0aGlzKSk7CiAgfSwKICBhY3RpdmF0ZWQ6IGZ1bmN0aW9uIGFjdGl2YXRlZCgpIHsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLm9uTG9hZFBhZ2UuYmluZCh0aGlzKSk7CiAgfSwKICBkZWFjdGl2YXRlZDogZnVuY3Rpb24gZGVhY3RpdmF0ZWQoKSB7CiAgICAvLyDlnKjnu4Tku7bliIfmjaLotbDml7bopoHnp7vpmaRzY3JvbGzkuovku7YKICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLm9uTG9hZFBhZ2UuYmluZCh0aGlzKSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBvbkxvYWRQYWdlOiBmdW5jdGlvbiBvbkxvYWRQYWdlKCkgewogICAgICAvLyDojrflj5ZjbGllbnRIZWlnaHQKICAgICAgdmFyIGNsaWVudEhlaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7IC8vIOiOt+WPlnNjcm9sbEhlaWdodAoKICAgICAgdmFyIHNjcm9sbEhlaWdodCA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0OyAvLyDojrflj5ZzY3JvbGxUb3Dov5nph4zms6jmhI/opoHlhbzlrrnkuIDkuIvvvIzmn5DkupvmnLrlnovnmoRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9w5Y+v6IO95Li6MAoKICAgICAgdmFyIHNjcm9sbFRvcCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7IC8vIOmAmuefpeeItue7hOS7tuinpuWPkea7muWKqOS6i+S7tgoKICAgICAgdGhpcy4kZW1pdCgnc2Nyb2xsJywgc2Nyb2xsVG9wKTsgLy8g6YCa55+l6Led56a75bqV6YOo6L+Y5pyJ5aSa5bCRcHjnmoTpmIjlgLwKCiAgICAgIHZhciBwcm9Mb2FkRGlzID0gNjA7IC8vIOWIpOaWreaYr+WQpumhtemdoua7muWKqOWIsOW6lemDqAoKICAgICAgaWYgKHNjcm9sbFRvcCArIGNsaWVudEhlaWdodCA+PSBzY3JvbGxIZWlnaHQgLSBwcm9Mb2FkRGlzKSB7CiAgICAgICAgLy8gNTYwIDE5MTUKICAgICAgICAvLyDmmK/lkKblt7Lnu4/mu5rliqjliLDmnIDlkI7kuIDpobUKICAgICAgICBpZiAoIXRoaXMubG9hZEVuZCkgewogICAgICAgICAgLy8g5Yik5pat5Zyo5LiA5LiqYXBp6K+35rGC5pyq5a6M5oiQ5pe25LiN6IO96Kem5Y+R56ys5LqM5qyh5rua5Yqo5Yiw5bqV6YOo55qE5Zue6LCDCiAgICAgICAgICBpZiAoIXRoaXMucmVhZHlUb0xvYWQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSAvLyDpgJrnn6XniLbnu4Tku7bop6blj5Hmu5rliqjliLDlupXpg6jkuovku7YKCgogICAgICAgICAgdGhpcy4kZW1pdCgnbG9hZENhbGxiYWNrJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;AASA,eAAA;AACA,EAAA,IAAA,EAAA,YADA;AAEA,EAAA,KAAA,EAAA;AACA,IAAA,WAAA,EAAA,OADA;AAEA,IAAA,KAAA,EAAA,OAFA;AAGA,IAAA,QAAA,EAAA;AAHA,GAFA;AAOA,EAAA,QAAA,EAAA;AACA,IAAA,OADA,qBACA;AACA,aAAA,KAAA,KAAA,IAAA,KAAA,QAAA,CAAA,MAAA,IAAA,CAAA;AACA;AAHA,GAPA;AAYA,EAAA,OAZA,qBAYA;AACA,IAAA,MAAA,CAAA,gBAAA,CAAA,QAAA,EAAA,KAAA,UAAA,CAAA,IAAA,CAAA,IAAA,CAAA;AACA,GAdA;AAeA,EAAA,aAfA,2BAeA;AACA;AACA,IAAA,MAAA,CAAA,mBAAA,CAAA,QAAA,EAAA,KAAA,UAAA,CAAA,IAAA,CAAA,IAAA,CAAA;AACA,GAlBA;AAmBA,EAAA,SAnBA,uBAmBA;AACA,IAAA,MAAA,CAAA,gBAAA,CAAA,QAAA,EAAA,KAAA,UAAA,CAAA,IAAA,CAAA,IAAA,CAAA;AACA,GArBA;AAsBA,EAAA,WAtBA,yBAsBA;AACA;AACA,IAAA,MAAA,CAAA,mBAAA,CAAA,QAAA,EAAA,KAAA,UAAA,CAAA,IAAA,CAAA,IAAA,CAAA;AACA,GAzBA;AA0BA,EAAA,OAAA,EAAA;AACA,IAAA,UADA,wBACA;AACA;AACA,UAAA,YAAA,GAAA,QAAA,CAAA,eAAA,CAAA,YAAA,CAFA,CAGA;;AACA,UAAA,YAAA,GAAA,QAAA,CAAA,IAAA,CAAA,YAAA,CAJA,CAKA;;AACA,UAAA,SAAA,GAAA,QAAA,CAAA,eAAA,CAAA,SAAA,IAAA,QAAA,CAAA,IAAA,CAAA,SAAA,CANA,CAQA;;AACA,WAAA,KAAA,CAAA,QAAA,EAAA,SAAA,EATA,CAUA;;AACA,UAAA,UAAA,GAAA,EAAA,CAXA,CAYA;;AACA,UAAA,SAAA,GAAA,YAAA,IAAA,YAAA,GAAA,UAAA,EAAA;AAAA;AACA;AACA,YAAA,CAAA,KAAA,OAAA,EAAA;AACA;AACA,cAAA,CAAA,KAAA,WAAA,EAAA;AACA;AACA,WAJA,CAMA;;;AACA,eAAA,KAAA,CAAA,cAAA;AACA;AACA;AACA;AA1BA;AA1BA,CAAA","sourcesContent":["<template>\n  <div class=\"scrollview\">\n    <slot></slot>\n    <div class=\"loadmore\">\n      <span class=\"loadmore-tips\">{{loadEnd ? '已加载完毕':'正在加载...'}}</span>\n    </div>\n  </div>\n</template>\n<script>\n  export default {\n  name: 'scrollview',\n  props:{\n    readyToLoad: Boolean,\n    isend: Boolean,\n    dataList: Array\n  },\n  computed:{\n    loadEnd(){\n      return this.isend || this.dataList.length == 0\n    }\n  },\n  mounted () {\n    window.addEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  beforeDestroy () {\n    // 在组件销毁时要移除scroll事件\n    window.removeEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  activated () {\n    window.addEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  deactivated () {\n    // 在组件切换走时要移除scroll事件\n    window.removeEventListener('scroll', this.onLoadPage.bind(this))\n  },\n  methods:{\n    onLoadPage () {\n      // 获取clientHeight\n      let clientHeight = document.documentElement.clientHeight\n      // 获取scrollHeight\n      let scrollHeight = document.body.scrollHeight\n      // 获取scrollTop这里注意要兼容一下，某些机型的document.documentElement.scrollTop可能为0\n      let scrollTop = document.documentElement.scrollTop || document.body.scrollTop\n\n      // 通知父组件触发滚动事件\n      this.$emit('scroll', scrollTop)\n      // 通知距离底部还有多少px的阈值\n      let proLoadDis = 60\n      // 判断是否页面滚动到底部\n      if ((scrollTop + clientHeight) >= (scrollHeight - proLoadDis)) { // 560 1915\n        // 是否已经滚动到最后一页\n        if (!this.loadEnd) {\n          // 判断在一个api请求未完成时不能触发第二次滚动到底部的回调\n          if (!this.readyToLoad) {\n            return\n          }\n\n          // 通知父组件触发滚动到底部事件\n          this.$emit('loadCallback')\n        }\n      }\n    }\n  }\n\n}\n</script>\n<style scoped>\n.loadmore {\n  width: 65%;\n  margin: 20px auto;\n  line-height: 20px;\n  font-size: 14px;\n  text-align: center;\n}\n.loadmore-tips {\n  display: inline-block;\n  vertical-align: middle;\n  color: #ababab;\n}\n</style>"],"sourceRoot":"src/components/scrollview"}]}