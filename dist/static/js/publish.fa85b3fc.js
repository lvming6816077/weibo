(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["publish"],{"1e63":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("headerbar",{attrs:{useRightBtn:"发表",useBack:!0,title:"发表"},on:{rightBtnClick:t.publish}}),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.postContent,expression:"postContent"}],attrs:{id:"postContent",maxlength:"300",placeholder:"分享新鲜事..."},domProps:{value:t.postContent},on:{input:[function(e){e.target.composing||(t.postContent=e.target.value)},t.oninput]}}),i("div",{staticClass:"text-count"},[i("span",{staticClass:"left-count"},[t._v(t._s(t.textCount))]),t._v("/300")]),i("div",{staticClass:"selected-images"},[t._l(t.imageList,(function(e,n){return i("div",{key:n,staticClass:"image-item",style:t.imgStyle(e)},[i("div",{staticClass:"delete-icon",on:{click:function(e){return t.deleteImage(n)}}})])})),i("div",{staticClass:"plus-image",on:{click:t.openFileUploader}})],2),i("input",{ref:"fileUploader",attrs:{type:"file",id:"fileUploader",accept:"image/*",multiple:"multiple"},on:{change:t.fileChange}})],1)},a=[],s=(i("a434"),i("1c80")),r={name:"publish",components:{headerbar:s["a"]},data:function(){return{postContent:"",textCount:0,imageList:[]}},computed:{imgStyle:function(){return function(t){return{backgroundImage:"url("+t.base64+")"}}},currentUser:function(){return this.$store.state.currentUser}},methods:{oninput:function(){this.textCount=this.postContent.length},openFileUploader:function(){this.$refs.fileUploader.click()},fileChange:function(t){for(var e=this,i=t.target.files,n=0;n<i.length;n++){var a=new FileReader;a.readAsDataURL(i[n]),a.onload=function(t){var i=new Image;i.onload=function(){e.imageList.push({base64:t.target.result,width:i.width,height:i.height})},i.src=t.target.result}}t.target.value=null},deleteImage:function(t){this.imageList.splice(t,1)},publish:function(){for(var t=[],e=0;e<this.imageList.length;e++)t.push({url:this.imageList[e].base64,geo:{width:this.imageList[e].width,height:this.imageList[e].height},large:{url:this.imageList[e].base64}});var i={mblog:{id:Date.now(),reposts_count:0,comments_count:0,attitudes_count:0,source:"微博mobile版",text:this.postContent,pics:t,user:{screen_name:this.currentUser.screen_name,profile_image_url:this.currentUser.profile_image_url,badge:{user_name_certificate:this.currentUser.verified}}}};this.$store.dispatch("addPost",i),mui.toast("发表成功"),this.$router.back()}}},o=r,l=(i("65a7"),i("2877")),c=Object(l["a"])(o,n,a,!1,null,"0361b1a8",null);e["default"]=c.exports},"48a5":function(t,e,i){},"65a7":function(t,e,i){"use strict";var n=i("48a5"),a=i.n(n);a.a},a434:function(t,e,i){"use strict";var n=i("23e7"),a=i("23cb"),s=i("a691"),r=i("50c4"),o=i("7b0b"),l=i("65f0"),c=i("8418"),u=i("1dde"),h=i("ae40"),d=u("splice"),p=h("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,f=Math.min,m=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d||!p},{splice:function(t,e){var i,n,u,h,d,p,C=o(this),b=r(C.length),_=a(t,b),w=arguments.length;if(0===w?i=n=0:1===w?(i=0,n=b-_):(i=w-2,n=f(g(s(e),0),b-_)),b+i-n>m)throw TypeError(v);for(u=l(C,n),h=0;h<n;h++)d=_+h,d in C&&c(u,h,C[d]);if(u.length=n,i<n){for(h=_;h<b-n;h++)d=h+n,p=h+i,d in C?C[p]=C[d]:delete C[p];for(h=b;h>b-n+i;h--)delete C[h-1]}else if(i>n)for(h=b-n;h>_;h--)d=h+n-1,p=h+i-1,d in C?C[p]=C[d]:delete C[p];for(h=0;h<i;h++)C[h+_]=arguments[h+2];return C.length=b-n+i,u}})}}]);
//# sourceMappingURL=publish.fa85b3fc.js.map